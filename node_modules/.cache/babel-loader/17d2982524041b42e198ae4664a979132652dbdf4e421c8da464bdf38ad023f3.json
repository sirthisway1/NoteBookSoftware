{"ast":null,"code":"var __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, {\n  enumerable: true,\n  configurable: true,\n  writable: true,\n  value\n}) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {})) if (__hasOwnProp.call(b, prop)) __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols) for (var prop of __getOwnPropSymbols(b)) {\n    if (__propIsEnum.call(b, prop)) __defNormalProp(a, prop, b[prop]);\n  }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nimport { defineComponent, ref, shallowRef, onMounted, watch, toRaw, openBlock, createElementBlock, watchEffect } from \"vue\";\nimport { createEditor, DomEditor, createToolbar } from \"@wangeditor/editor\";\nfunction genErrorInfo(fnName) {\n  let info = `\\u8BF7\\u4F7F\\u7528 '@${fnName}' \\u4E8B\\u4EF6\\uFF0C\\u4E0D\\u8981\\u653E\\u5728 props \\u4E2D`;\n  info += `\nPlease use '@${fnName}' event instead of props`;\n  return info;\n}\nvar _export_sfc = (sfc, props) => {\n  for (const [key, val] of props) {\n    sfc[key] = val;\n  }\n  return sfc;\n};\nconst _sfc_main$1 = defineComponent({\n  props: {\n    mode: {\n      type: String,\n      default: \"default\"\n    },\n    defaultContent: {\n      type: Array,\n      default: []\n    },\n    defaultHtml: {\n      type: String,\n      default: \"\"\n    },\n    defaultConfig: {\n      type: Object,\n      default: {}\n    },\n    modelValue: {\n      type: String,\n      default: \"\"\n    }\n  },\n  setup(props, context) {\n    const box = ref(null);\n    const editorRef = shallowRef(null);\n    const curValue = ref(\"\");\n    const initEditor = () => {\n      if (!box.value) return;\n      const defaultContent = toRaw(props.defaultContent);\n      createEditor({\n        selector: box.value,\n        mode: props.mode,\n        content: defaultContent || [],\n        html: props.defaultHtml || props.modelValue || \"\",\n        config: __spreadProps(__spreadValues({}, props.defaultConfig), {\n          onCreated(editor) {\n            editorRef.value = editor;\n            context.emit(\"onCreated\", editor);\n            if (props.defaultConfig.onCreated) {\n              const info = genErrorInfo(\"onCreated\");\n              throw new Error(info);\n            }\n          },\n          onChange(editor) {\n            const editorHtml = editor.getHtml();\n            curValue.value = editorHtml;\n            context.emit(\"update:modelValue\", editorHtml);\n            context.emit(\"onChange\", editor);\n            if (props.defaultConfig.onChange) {\n              const info = genErrorInfo(\"onChange\");\n              throw new Error(info);\n            }\n          },\n          onDestroyed(editor) {\n            context.emit(\"onDestroyed\", editor);\n            if (props.defaultConfig.onDestroyed) {\n              const info = genErrorInfo(\"onDestroyed\");\n              throw new Error(info);\n            }\n          },\n          onMaxLength(editor) {\n            context.emit(\"onMaxLength\", editor);\n            if (props.defaultConfig.onMaxLength) {\n              const info = genErrorInfo(\"onMaxLength\");\n              throw new Error(info);\n            }\n          },\n          onFocus(editor) {\n            context.emit(\"onFocus\", editor);\n            if (props.defaultConfig.onFocus) {\n              const info = genErrorInfo(\"onFocus\");\n              throw new Error(info);\n            }\n          },\n          onBlur(editor) {\n            context.emit(\"onBlur\", editor);\n            if (props.defaultConfig.onBlur) {\n              const info = genErrorInfo(\"onBlur\");\n              throw new Error(info);\n            }\n          },\n          customAlert(info, type) {\n            context.emit(\"customAlert\", info, type);\n            if (props.defaultConfig.customAlert) {\n              const info2 = genErrorInfo(\"customAlert\");\n              throw new Error(info2);\n            }\n          },\n          customPaste: (editor, event) => {\n            if (props.defaultConfig.customPaste) {\n              const info = genErrorInfo(\"customPaste\");\n              throw new Error(info);\n            }\n            let res;\n            context.emit(\"customPaste\", editor, event, val => {\n              res = val;\n            });\n            return res;\n          }\n        })\n      });\n    };\n    function setHtml(newHtml) {\n      const editor = editorRef.value;\n      if (editor == null) return;\n      editor.setHtml(newHtml);\n    }\n    onMounted(() => {\n      initEditor();\n    });\n    watch(() => props.modelValue, newVal => {\n      if (newVal === curValue.value) return;\n      setHtml(newVal);\n    });\n    return {\n      box\n    };\n  }\n});\nconst _hoisted_1$1 = {\n  ref: \"box\",\n  style: {\n    \"height\": \"100%\"\n  }\n};\nfunction _sfc_render$1(_ctx, _cache, $props, $setup, $data, $options) {\n  return openBlock(), createElementBlock(\"div\", _hoisted_1$1, null, 512);\n}\nvar Editor = /* @__PURE__ */_export_sfc(_sfc_main$1, [[\"render\", _sfc_render$1]]);\nconst _sfc_main = defineComponent({\n  props: {\n    editor: {\n      type: Object\n    },\n    mode: {\n      type: String,\n      default: \"default\"\n    },\n    defaultConfig: {\n      type: Object,\n      default: {}\n    }\n  },\n  setup(props) {\n    const selector = ref(null);\n    const create = editor => {\n      if (!selector.value) return;\n      if (editor == null) {\n        throw new Error(\"Not found instance of Editor when create <Toolbar/> component\");\n      }\n      if (DomEditor.getToolbar(editor)) return;\n      createToolbar({\n        editor,\n        selector: selector.value || \"<div></div>\",\n        mode: props.mode,\n        config: props.defaultConfig\n      });\n    };\n    watchEffect(() => {\n      const {\n        editor\n      } = props;\n      if (editor == null) return;\n      create(editor);\n    });\n    return {\n      selector\n    };\n  }\n});\nconst _hoisted_1 = {\n  ref: \"selector\"\n};\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  return openBlock(), createElementBlock(\"div\", _hoisted_1, null, 512);\n}\nvar Toolbar = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\nexport { Editor, Toolbar };","map":{"version":3,"names":["fnName","info","_export_sfc","sfc","props","key","val","_sfc_main$1","defineComponent","mode","type","String","default","defaultContent","Array","defaultHtml","defaultConfig","Object","modelValue","setup","context","box","ref","editorRef","shallowRef","curValue","initEditor","value","toRaw","selector","content","html","config","__spreadProps","__spreadValues","onCreated","editor","emit","genErrorInfo","Error","onChange","editorHtml","getHtml","onDestroyed","onMaxLength","onFocus","onBlur","customAlert","info2","customPaste","event","res","newHtml","setHtml","newVal","_hoisted_1$1","style","_cache","$props","$setup","$data","$options","_sfc_main","create","DomEditor","getToolbar"],"sources":["../src/utils/create-info.ts","../plugin-vue:export-helper","../src/components/Editor.vue","../src/components/Toolbar.vue"],"sourcesContent":["/**\n * @description 错误提示信息\n * @author liuqh\n */\nexport function genErrorInfo(fnName: string): string {\n  let info = `请使用 '@${fnName}' 事件，不要放在 props 中`\n  info += `\\nPlease use '@${fnName}' event instead of props`\n  return info\n}","\nexport default (sfc, props) => {\n  for (const [key, val] of props) {\n    sfc[key] = val\n  }\n  return sfc\n}\n","<template>\n  <div ref=\"box\" style=\"height: 100%\"></div>\n</template>\n\n<script lang=\"ts\">\nimport { onMounted, defineComponent, ref, PropType, toRaw, watch, shallowRef } from 'vue'\nimport { createEditor, IEditorConfig, SlateDescendant, IDomEditor } from '@wangeditor/editor'\nimport { genErrorInfo } from '../utils/create-info'\n\nexport default defineComponent({\n  props: {\n    /** 编辑器模式 */\n    mode: {\n      type: String,\n      default: 'default',\n    },\n    /** 编辑器默认内容 */\n    defaultContent: {\n      type: Array as PropType<SlateDescendant[]>,\n      default: [],\n    },\n    defaultHtml: {\n      type: String,\n      default: '',\n    },\n    /** 编辑器默认配置 */\n    defaultConfig: {\n      type: Object as PropType<Partial<IEditorConfig>>,\n      default: {},\n    },\n    /* 自定义 v-model */\n    modelValue: {\n      type: String,\n      default: '',\n    },\n  },\n  setup(props, context) {\n    const box = ref(null) // 编辑器容器\n\n    const editorRef = shallowRef<null | IDomEditor>(null) // editor 实例，必须用 shallowRef\n\n    const curValue = ref('') // 记录 editor 当前 html 内容\n\n    /**\n     * 初始化编辑器\n     */\n    const initEditor = () => {\n      if (!box.value) return\n      // 获取原始数据，解除响应式特性\n      const defaultContent = toRaw(props.defaultContent)\n\n      createEditor({\n        selector: box.value! as Element,\n        mode: props.mode,\n        content: defaultContent || [],\n        html: props.defaultHtml || props.modelValue || '',\n        config: {\n          ...props.defaultConfig,\n          onCreated(editor) {\n            editorRef.value = editor // 记录 editor 实例\n\n            context.emit('onCreated', editor)\n\n            if (props.defaultConfig.onCreated) {\n              const info = genErrorInfo('onCreated')\n              throw new Error(info)\n            }\n          },\n          onChange(editor) {\n            const editorHtml = editor.getHtml()\n            curValue.value = editorHtml // 记录当前内容\n            context.emit('update:modelValue', editorHtml) // 触发 v-model 值变化\n\n            context.emit('onChange', editor)\n            if (props.defaultConfig.onChange) {\n              const info = genErrorInfo('onChange')\n              throw new Error(info)\n            }\n          },\n          onDestroyed(editor) {\n            context.emit('onDestroyed', editor)\n            if (props.defaultConfig.onDestroyed) {\n              const info = genErrorInfo('onDestroyed')\n              throw new Error(info)\n            }\n          },\n          onMaxLength(editor) {\n            context.emit('onMaxLength', editor)\n            if (props.defaultConfig.onMaxLength) {\n              const info = genErrorInfo('onMaxLength')\n              throw new Error(info)\n            }\n          },\n          onFocus(editor) {\n            context.emit('onFocus', editor)\n            if (props.defaultConfig.onFocus) {\n              const info = genErrorInfo('onFocus')\n              throw new Error(info)\n            }\n          },\n          onBlur(editor) {\n            context.emit('onBlur', editor)\n            if (props.defaultConfig.onBlur) {\n              const info = genErrorInfo('onBlur')\n              throw new Error(info)\n            }\n          },\n          customAlert(info, type) {\n            context.emit('customAlert', info, type)\n            // @ts-ignore\n            if (props.defaultConfig.customAlert) {\n              const info = genErrorInfo('customAlert')\n              throw new Error(info)\n            }\n          },\n          customPaste: (editor, event): any => {\n            if (props.defaultConfig.customPaste) {\n              const info = genErrorInfo('customPaste')\n              throw new Error(info)\n            }\n            let res\n            context.emit('customPaste', editor, event, (val: boolean) => {\n              res = val\n            })\n            return res\n          },\n        },\n      })\n    }\n\n    /**\n     * 设置 HTML\n     * @param newHtml new html\n     */\n    function setHtml(newHtml: string) {\n      const editor = editorRef.value\n      if (editor == null) return\n      editor.setHtml(newHtml)\n    }\n\n    /**\n     * 元素挂在后初始化编辑器\n     */\n    onMounted(() => {\n      initEditor()\n    })\n\n    // 监听 v-model 值变化\n    watch(\n      () => props.modelValue,\n      newVal => {\n        if (newVal === curValue.value) return // 和当前内容一样，则忽略\n\n        // 重新设置 HTML\n        setHtml(newVal)\n      }\n    )\n\n    return {\n      box,\n    }\n  },\n})\n</script>\n","<template>\n  <div ref=\"selector\"></div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, ref, watchEffect, PropType } from 'vue'\nimport { createToolbar, IToolbarConfig, IDomEditor, DomEditor } from '@wangeditor/editor'\n\nexport default defineComponent({\n  props: {\n    // editor 实例\n    editor: {\n      type: Object as PropType<IDomEditor>\n    },\n    /** 编辑器模式 */\n    mode: {\n      type: String,\n      default: 'default',\n    },\n    /** 编辑器默认配置 */\n    defaultConfig: {\n      type: Object as PropType<Partial<IToolbarConfig>>,\n      default: {},\n    },\n  },\n  setup(props) {\n    // toolbar 容器\n    const selector = ref(null)\n\n    /**\n     * 初始化 toolbar\n     */\n    const create = (editor: IDomEditor) => {\n      if (!selector.value) return\n      if (editor == null) {\n        throw new Error('Not found instance of Editor when create <Toolbar/> component')\n      }\n      if (DomEditor.getToolbar(editor)) return // 不重复创建\n\n      createToolbar({\n        editor,\n        selector: (selector.value! as Element) || '<div></div>',\n        mode: props.mode,\n        config: props.defaultConfig,\n      })\n    }\n\n    watchEffect( () => {\n      const { editor } = props\n      if (editor == null) return\n      create(editor) // 初始化 toolbar\n    })\n\n    return {\n      selector,\n    }\n  },\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}